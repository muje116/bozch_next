{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/Websites/bozch_next/bozch/lib/db.ts"],"sourcesContent":["import mysql from \"mysql2/promise\"\n\n// Create the connection pool. The pool-specific settings are the defaults\nconst pool = mysql.createPool({\n  host: process.env.DB_HOST || \"localhost\",\n  user: process.env.DB_USER || \"root\",\n  password: process.env.DB_PASSWORD || \"\",\n  database: process.env.DB_NAME || \"bozch_cms\",\n  waitForConnections: true,\n  connectionLimit: 10,\n  maxIdle: 10, // max idle connections, the default value is the same as `connectionLimit`\n  idleTimeout: 60000, // idle connections timeout, in milliseconds, the default value 60000\n  queueLimit: 0,\n  enableKeepAlive: true,\n  keepAliveInitialDelay: 0,\n})\n\n// Helper function to execute queries\nexport async function sql(query: string, values: any[] = []) {\n  try {\n    const [results] = await pool.execute(query, values)\n    return results\n  } catch (error) {\n    console.error(\"Database query error:\", error)\n    throw error\n  }\n}\n\n// Type definitions for database tables\nexport interface AdminUser {\n  id: number\n  email: string\n  password_hash: string\n  name: string\n  role: string\n  created_at: Date\n  updated_at: Date\n}\n\nexport interface SiteSetting {\n  id: number\n  setting_key: string\n  setting_value: string\n  setting_type: string\n  updated_at: Date\n}\n\nexport interface HeroSlide {\n  id: number\n  title: string\n  subtitle: string\n  image_url: string\n  cta_text: string\n  cta_link: string\n  display_order: number\n  is_active: boolean\n  created_at: Date\n  updated_at: Date\n}\n\nexport interface ImpactStat {\n  id: number\n  label: string\n  value: number\n  suffix: string\n  icon: string\n  display_order: number\n  is_active: boolean\n  updated_at: Date\n}\n\nexport interface Program {\n  id: number\n  title: string\n  description: string\n  long_description: string\n  icon: string\n  image_url: string\n  display_order: number\n  is_active: boolean\n  created_at: Date\n  updated_at: Date\n}\n\nexport interface TeamMember {\n  id: number\n  name: string\n  role: string\n  bio: string\n  image_url: string\n  email: string\n  linkedin_url: string\n  display_order: number\n  is_active: boolean\n  created_at: Date\n  updated_at: Date\n}\n\nexport interface Milestone {\n  id: number\n  year: string\n  title: string\n  description: string\n  display_order: number\n  is_active: boolean\n  created_at: Date\n  updated_at: Date\n}\n\nexport interface CoreValue {\n  id: number\n  title: string\n  description: string\n  icon: string\n  display_order: number\n  is_active: boolean\n  updated_at: Date\n}\n\nexport interface ContactSubmission {\n  id: number\n  name: string\n  email: string\n  subject: string\n  message: string\n  is_read: boolean\n  created_at: Date\n}\n\nexport interface InterestSubmission {\n  id: number\n  name: string\n  email: string\n  phone: string\n  interest: string\n  message: string\n  is_read: boolean\n  created_at: Date\n}\n\nexport interface NewsletterSubscriber {\n  id: number\n  email: string\n  is_active: boolean\n  subscribed_at: Date\n}\n\nexport interface PageContent {\n  id: number\n  page_slug: string\n  section_key: string\n  title: string\n  content: string\n  updated_at: Date\n}\n\nexport interface Partner {\n  id: number\n  name: string\n  logo_url: string\n  website_url: string\n  display_order: number\n  is_active: boolean\n  created_at: Date\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,0EAA0E;AAC1E,MAAM,OAAO,8IAAK,CAAC,UAAU,CAAC;IAC5B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,oBAAoB;IACpB,iBAAiB;IACjB,SAAS;IACT,aAAa;IACb,YAAY;IACZ,iBAAiB;IACjB,uBAAuB;AACzB;AAGO,eAAe,IAAI,KAAa,EAAE,SAAgB,EAAE;IACzD,IAAI;QACF,MAAM,CAAC,QAAQ,GAAG,MAAM,KAAK,OAAO,CAAC,OAAO;QAC5C,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/Websites/bozch_next/bozch/lib/auth.ts"],"sourcesContent":["import { cookies } from \"next/headers\"\nimport { sql } from \"./db\"\nimport bcrypt from \"bcryptjs\"\nimport { SignJWT, jwtVerify } from \"jose\"\n\nconst JWT_SECRET = new TextEncoder().encode(\n  process.env.JWT_SECRET || \"bozch-secret-key-change-in-production\"\n)\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 10)\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  try {\n    // bcrypt.compare handles the comparison between plain text password and hashed password\n    const isMatch = await bcrypt.compare(password, hash)\n    return isMatch\n  } catch (error) {\n    console.error(\"Password verification error:\", error)\n    return false\n  }\n}\n\nexport async function createToken(userId: number, email: string, role: string): Promise<string> {\n  return new SignJWT({ userId, email, role })\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(\"7d\")\n    .sign(JWT_SECRET)\n}\n\nexport async function verifyToken(token: string) {\n  try {\n    const { payload } = await jwtVerify(token, JWT_SECRET)\n    return payload as { userId: number; email: string; role: string }\n  } catch {\n    return null\n  }\n}\n\nexport async function getSession() {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"admin_token\")?.value\n  if (!token) return null\n  return verifyToken(token)\n}\n\nexport async function login(email: string, password: string) {\n  try {\n    // Fetch user from database\n    const users = (await sql(\"SELECT * FROM admin_users WHERE email = ?\", [email])) as any[]\n    \n    console.log(\"Login attempt for email:\", email)\n    console.log(\"Users found:\", users.length)\n    \n    if (users.length === 0) {\n      console.log(\"No user found with this email\")\n      return null\n    }\n    \n    const user = users[0]\n    \n    // Check if password_hash exists\n    if (!user.password_hash) {\n      console.error(\"No password_hash field found in user record\")\n      return null\n    }\n\n    //hash the password\n    const hashedPassword = await hashPassword(password)\n    console.log(\"hashedPassword\", hashedPassword);\n    console.log(\"user.password_hash\", user.password_hash);\n    \n    console.log(\"Comparing password with hash from database\")\n    console.log(\"Hash format check:\", user.password_hash.substring(0, 4)) // Should be $2b$ or $2a$\n    \n    // Compare plain text password with hashed password from database\n    const isValid = await verifyPassword(password, user.password_hash)\n    \n    console.log(\"Password validation result:\", isValid)\n    \n    if (!isValid) {\n      console.log(\"Invalid password\")\n      return null\n    }\n    \n    // Create JWT token\n    const token = await createToken(user.id, user.email, user.role)\n    \n    console.log(\"Login successful for user:\", user.email)\n    \n    return {\n      user: {\n        id: user.id,\n        email: user.email,\n        name: user.name,\n        role: user.role,\n      },\n      token,\n    }\n  } catch (error) {\n    console.error(\"Login error:\", error)\n    return null\n  }\n}\n\nexport async function logout() {\n  const cookieStore = await cookies()\n  cookieStore.delete(\"admin_token\")\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAAA;;;;;AAEA,MAAM,aAAa,IAAI,cAAc,MAAM,CACzC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAGrB,eAAe,aAAa,QAAgB;IACjD,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,IAAI;QACF,wFAAwF;QACxF,MAAM,UAAU,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU;QAC/C,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO;IACT;AACF;AAEO,eAAe,YAAY,MAAc,EAAE,KAAa,EAAE,IAAY;IAC3E,OAAO,IAAI,kKAAO,CAAC;QAAE;QAAQ;QAAO;IAAK,GACtC,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC;AACV;AAEO,eAAe,YAAY,KAAa;IAC7C,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO;QAC3C,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,gBAAgB;IAC9C,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,YAAY;AACrB;AAEO,eAAe,MAAM,KAAa,EAAE,QAAgB;IACzD,IAAI;QACF,2BAA2B;QAC3B,MAAM,QAAS,MAAM,IAAA,kHAAG,EAAC,6CAA6C;YAAC;SAAM;QAE7E,QAAQ,GAAG,CAAC,4BAA4B;QACxC,QAAQ,GAAG,CAAC,gBAAgB,MAAM,MAAM;QAExC,IAAI,MAAM,MAAM,KAAK,GAAG;YACtB,QAAQ,GAAG,CAAC;YACZ,OAAO;QACT;QAEA,MAAM,OAAO,KAAK,CAAC,EAAE;QAErB,gCAAgC;QAChC,IAAI,CAAC,KAAK,aAAa,EAAE;YACvB,QAAQ,KAAK,CAAC;YACd,OAAO;QACT;QAEA,mBAAmB;QACnB,MAAM,iBAAiB,MAAM,aAAa;QAC1C,QAAQ,GAAG,CAAC,kBAAkB;QAC9B,QAAQ,GAAG,CAAC,sBAAsB,KAAK,aAAa;QAEpD,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,sBAAsB,KAAK,aAAa,CAAC,SAAS,CAAC,GAAG,KAAI,yBAAyB;QAE/F,iEAAiE;QACjE,MAAM,UAAU,MAAM,eAAe,UAAU,KAAK,aAAa;QAEjE,QAAQ,GAAG,CAAC,+BAA+B;QAE3C,IAAI,CAAC,SAAS;YACZ,QAAQ,GAAG,CAAC;YACZ,OAAO;QACT;QAEA,mBAAmB;QACnB,MAAM,QAAQ,MAAM,YAAY,KAAK,EAAE,EAAE,KAAK,KAAK,EAAE,KAAK,IAAI;QAE9D,QAAQ,GAAG,CAAC,8BAA8B,KAAK,KAAK;QAEpD,OAAO;YACL,MAAM;gBACJ,IAAI,KAAK,EAAE;gBACX,OAAO,KAAK,KAAK;gBACjB,MAAM,KAAK,IAAI;gBACf,MAAM,KAAK,IAAI;YACjB;YACA;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB","debugId":null}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/Websites/bozch_next/bozch/app/api/admin/hero-slides/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { getSession } from \"@/lib/auth\"\nimport { sql } from \"@/lib/db\"\n\nexport async function GET() {\n  try {\n    const slides = await sql(\"SELECT * FROM hero_slides ORDER BY display_order ASC\")\n    return NextResponse.json(slides)\n  } catch (error) {\n    console.error(\"Error fetching hero slides:\", error)\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 })\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const session = await getSession()\n    if (!session) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n    }\n\n    const data = await request.json()\n    const result = (await sql(\n      \"INSERT INTO hero_slides (title, subtitle, image_url, cta_text, cta_link, display_order, is_active) VALUES (?, ?, ?, ?, ?, ?, ?)\",\n      [\n        data.title,\n        data.subtitle,\n        data.image_url,\n        data.cta_text,\n        data.cta_link,\n        data.display_order || 0,\n        data.is_active !== false,\n      ]\n    )) as any\n\n    const newSlide = {\n      id: result.insertId,\n      ...data,\n      display_order: data.display_order || 0,\n      is_active: data.is_active !== false,\n      created_at: new Date(),\n      updated_at: new Date(),\n    }\n\n    return NextResponse.json(newSlide)\n  } catch (error) {\n    console.error(\"Error creating hero slide:\", error)\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM,IAAA,kHAAG,EAAC;QACzB,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,2HAAU;QAChC,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,SAAU,MAAM,IAAA,kHAAG,EACvB,mIACA;YACE,KAAK,KAAK;YACV,KAAK,QAAQ;YACb,KAAK,SAAS;YACd,KAAK,QAAQ;YACb,KAAK,QAAQ;YACb,KAAK,aAAa,IAAI;YACtB,KAAK,SAAS,KAAK;SACpB;QAGH,MAAM,WAAW;YACf,IAAI,OAAO,QAAQ;YACnB,GAAG,IAAI;YACP,eAAe,KAAK,aAAa,IAAI;YACrC,WAAW,KAAK,SAAS,KAAK;YAC9B,YAAY,IAAI;YAChB,YAAY,IAAI;QAClB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF","debugId":null}}]
}